<script src="lib/qrcode.min.js"></script>
<script src="lib/emergency-kit.js"></script>

<script>

function getQRCodeDataURL(url, opts) {
    var settings = opts;
    settings.text = url;
    settings.correctLevel = 1;

    // Must render to a div before extracting the URL
    var qr = new QRCode(document.createElement("div"), settings);
    var data = qr._el.querySelector("canvas").toDataURL();
    return data;
}

var k = new EmergencyKit({
    email: "wendyappleseed@me.com",
    name: "Wendy Appleseed",
    accountKey: "AK-123-456",
    domain: "appleseed",
    teamURL: "appleseed.1password.com",
    qrCode: getQRCodeDataURL("hello world", {
           colorDark: "#000",
           colorLight: "#fff",
           width: 144,
           height: 144
    }),
    filename: "1password.pdf"
});

k.getDownloadURL().then(function(url) {
    console.log('yo');
    document.write("<a target='_blank' href='" + url + "'>View PDF</a>");
});
</script>
